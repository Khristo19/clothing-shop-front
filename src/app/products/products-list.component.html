<div style="display:flex;flex-direction:column;gap:1.5rem">
  <header style="display:flex;justify-content:space-between;align-items:flex-start;gap:1rem">
    <div>
      <h1 style="margin:0;font-size:1.5rem">Product Catalog</h1>
      <p style="margin:0;color:#6b7280">Review inventory, adjust stock levels, and add new items.</p>
    </div>
    <button style="padding:.5rem 1rem" (click)="showCreate.set(true)">Add Product</button>
  </header>

  <section style="display:flex;gap:1rem;flex-wrap:wrap">
    <div style="flex:1 1 160px;padding:1rem;border:1px solid #e5e7eb;border-radius:10px;background:#f9fafb">
      <p style="margin:0;color:#6b7280;font-size:.875rem">Total products</p>
      <p style="margin:.25rem 0 0;font-size:1.5rem;font-weight:600">{{ totalCount() }}</p>
    </div>
    <div style="flex:1 1 160px;padding:1rem;border:1px solid #e5e7eb;border-radius:10px;background:#f9fafb">
      <p style="margin:0;color:#6b7280;font-size:.875rem">Low stock (&lt; 5)</p>
      <p style="margin:.25rem 0 0;font-size:1.5rem;font-weight:600">{{ lowStockCount() }}</p>
    </div>
  </section>

  <div style="display:flex;gap:.75rem;align-items:center">
    <input style="flex:1;padding:.5rem;border:1px solid #d1d5db;border-radius:8px" placeholder="Search by name or description" [value]="search()" (input)="search.set(($any($event.target)).value)" />
    <button (click)="reload()" style="padding:.5rem 1rem">Refresh</button>
  </div>

  <section *ngIf="error()" style="padding:.75rem;border-radius:8px;background:#fef2f2;color:#991b1b">
    {{ error() }}
  </section>
  <section *ngIf="loading()" style="padding:.75rem;border-radius:8px;background:#eff6ff;color:#1d4ed8">
    Loading latest catalog...
  </section>

  <section *ngIf="showCreate()" style="border:1px solid #e5e7eb;padding:1rem;border-radius:12px">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem">
      <h2 style="margin:0;font-size:1.25rem">Add a product</h2>
      <button type="button" (click)="showCreate.set(false)" style="padding:.25rem .75rem">Close</button>
    </div>
    <form [formGroup]="form" (ngSubmit)="create()" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:1rem">
      <div style="display:flex;flex-direction:column;gap:.25rem">
        <label>Name</label>
        <input formControlName="name" placeholder="Classic T-Shirt" />
      </div>
      <div style="display:flex;flex-direction:column;gap:.25rem">
        <label>Price</label>
        <input formControlName="price" type="number" step="0.01" />
      </div>
      <div style="display:flex;flex-direction:column;gap:.25rem">
        <label>Quantity</label>
        <input formControlName="quantity" type="number" />
      </div>
      <div style="display:flex;flex-direction:column;gap:.25rem">
        <label>Image URL</label>
        <input formControlName="image_url" placeholder="https://" />
      </div>
      <div style="display:flex;flex-direction:column;gap:.25rem;grid-column:1/-1">
        <label>Description</label>
        <textarea formControlName="description" rows="3" placeholder="Short description..."></textarea>
      </div>
      <div style="grid-column:1/-1;display:flex;justify-content:flex-end;gap:.5rem">
        <button type="button" (click)="showCreate.set(false)" style="padding:.5rem 1rem">Cancel</button>
        <button type="submit" style="padding:.5rem 1rem" [disabled]="form.invalid || loading()">Save product</button>
      </div>
    </form>
  </section>

  <div *ngIf="!loading() && filtered().length === 0" style="padding:1.5rem;border:1px dashed #d1d5db;border-radius:12px;text-align:center;color:#6b7280">
    No products match the current filters.
  </div>

  <div style="overflow:auto;border:1px solid #e5e7eb;border-radius:12px">
    <table style="width:100%;border-collapse:collapse">
      <thead style="background:#f3f4f6">
        <tr>
          <th style="text-align:left;padding:.75rem;font-weight:500">Product</th>
          <th style="text-align:left;padding:.75rem;font-weight:500">Price</th>
          <th style="text-align:left;padding:.75rem;font-weight:500">In stock</th>
          <th style="text-align:left;padding:.75rem;font-weight:500">Last updated</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let p of filtered(); trackBy: trackById" style="border-top:1px solid #f3f4f6">
          <td style="padding:.75rem">
            <div style="display:flex;flex-direction:column">
              <span style="font-weight:500">{{ p.name }}</span>
              <small style="color:#6b7280">{{ p.description || 'No description provided' }}</small>
            </div>
          </td>
          <td style="padding:.75rem">${{ p.price | number:'1.2-2' }}</td>
          <td style="padding:.75rem">
            <span [style.color]="p.quantity < 5 ? '#b91c1c' : '#166534'">
              {{ p.quantity }} units
            </span>
          </td>
          <td style="padding:.75rem">{{ p.created_at | date:'mediumDate' }}</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

